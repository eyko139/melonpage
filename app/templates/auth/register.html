{% extends "base.html" %}
{% block head %}
{% with messages = get_flashed_messages(with_categories=True) %}
{% if messages %}
    {% for category, message in messages %}
    {% if category == "error" %}
    <div class="alert alert-danger" role="alert">
        <h4 class "alert-heading">{{ message }}</h4> 
    </div>
    {% endif %}
    {% if category != "error" %}
    <div class="alert alert-success" role="alert">
        <h4 class="alert-heading">{{ message }}</h4> 
    </div>
    {% endif %}
    {% endfor %}
{% endif %}
{% endwith %}
{% endblock %}
{% block body %}
<div class="container">
    <h1 style="text-align: center">Register</h1>
    <form action="" novalidate class="main-form needs-validation" method="post" style="max-width: 500px; margin: auto">
        <div class="form-group" style="margin: 20px auto">
            <label for="username_input">Username</label>
            <input type="text" name="username_input" class="form-control" required>
        </div>
        <div class="form-group" style="margin: 20px auto">
            <label for="username">Email</label>
            <input type="email" name="usermail_input" class="form-control" required>
            <div class="invalid-feedback">Enter valid email</div>
        </div>
        <div class="form-group" style="margin: 20px auto">
            <label for="username">Password</label>
            <input type="password" name="userpassword_input" class="form-control" required>
        </div>
        <div class="form-group" style="margin: 20px auto">
            <label for="username">Confirm Password</label>
            <input type="password" name="passwordconfirm_input" class="form-control" oninput="pwconfirm(userpassword_input, passwordconfirm_input)" required>
            <div class="invalid-feedback">Passwords don't match</div>
        </div>
        <div class="form-group" style="margin: 20px auto">
            <button type="submit" class="btn btn-primary form-control">Submit</button>
        </div>

        <script>
            <!--using the browsers built-in form validation with javascript -->
                <!--the form div has to deactivate the browser built-in validation for the javascript to work -->
            var form = document.querySelector(".needs-validation");
            
            form.addEventListener("submit", function(event) {
                            if (form.checkValidity() === false) {
                                            event.preventDefault();
                                            event.stopPropagation();
                                        }
                            form.classList.add("was-validated");
                        })

            function pwconfirm(input, input2) {
                            if (input.value != input2.value) {
                                            input2.setCustomValidity("Passwords don't maatch");
                                        }
                            else {
                                            input2.setCustomValidity("");
                                        }
                        }


        </script>



    </form>
</div>
{% endblock %}
